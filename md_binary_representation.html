<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GTIRB: binary-representation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GTIRB
   &#160;<span id="projectnumber">v1.10.4</span>
   </div>
   <div id="projectbrief">GrammaTech Intermediate Representation for Binaries</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">binary-representation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md225">Binary Representation with GTIRB</a><ul><li class="level2"><a href="#autotoc_md226">Representing Binaries</a><ul><li class="level3"><a href="#autotoc_md227">Sections</a></li>
<li class="level3"><a href="#autotoc_md228">Symbols</a></li>
<li class="level3"><a href="#autotoc_md229">Byte Intervals</a></li>
<li class="level3"><a href="#autotoc_md230">Symbolic Expressions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md225"></a>
Binary Representation with GTIRB</h1>
<p><a class="anchor" id="binary-representation-with-gtirb"></a></p>
<ul>
<li><a href="#representing-binaries">Representing Binaries</a><ul>
<li><a href="#sections">Sections</a></li>
<li><a href="#symbols">Symbols</a></li>
<li><a href="#byte-intervals">Byte Intervals</a></li>
<li><a href="#symbolic-expressions">Symbolic Expressions</a></li>
</ul>
</li>
</ul>
<p>GTIRB portably encodes binaries from a range of standard executable and linkable formats, such as <a href="https://en.wikipedia.org/wiki/Executable_and_Linkable_Format">ELF</a>, <a href="https://en.wikipedia.org/wiki/Portable_Executable">PE</a>, and <a href="https://en.wikipedia.org/wiki/Mach-O">Mach-O</a>, allowing conversion to and from these formats to GTIRB. In ensure all information from the original binary is retained despite standard GTIRB data structures&ndash;which are intended to be general across all binary representations&ndash;being lossy for many aspects of particular representation, encoders are encouraged to include all raw bytes of the original file in the GTIRB encoding. In addition, GTIRB encodes information above and beyond what these formats store; it stores control flow, symbolization (reference) information, and other analysis results, with the goal of providing all essential information to support subsequent binary analysis and rewriting. Finally, GTIRB allows user-extensible data to be included in the form of AuxData tables which can easily reference other GTIRB elements&ndash;letting tools communicate with each other in a single standard in-file format.</p>
<h2><a class="anchor" id="autotoc_md226"></a>
Representing Binaries</h2>
<p><a class="anchor" id="representing-binaries"></a></p>
<p>Although executable file formats differ in many ways, they typically tend to have a similar structure. The bytes of the image are divided into sections, which contain the bytes consisting of the code and data along with information about how to load and adjust them at run-time. To facilitate linking with shared libraries, they have a symbol table, which specifies a list of names of entities this file provides or requires. To facilitate relocation in memory these files often contains a relocation table.</p>
<p>GTIRB contains all this information in standard forms. In GTIRB, a single executable or library is encoded as a <em>module</em>. A GTIRB file may have multiple modules, enclosed in a single <em>IR</em>. GTIRB encodes the standard features of all binary formats in the following structures:</p>
<h3><a class="anchor" id="autotoc_md227"></a>
Sections</h3>
<p><a class="anchor" id="sections"></a></p>
<p>Modules in GTIRB contain multiple <em>sections</em>. A section has a name reflecting any name given in the original file (e.g., <code>.text</code>), a set of properties, and a set of contents stored in <a href="#byte-intervals">byte intervals</a>.</p>
<h3><a class="anchor" id="autotoc_md228"></a>
Symbols</h3>
<p><a class="anchor" id="symbols"></a></p>
<p>Rather than storing a symbol table as a section, GTIRB stores a set of <em>symbols</em> associated with every module. These symbols have a name, a set of properties, and a <em>referent</em>. A referent may be an integer, indicating that the symbol is a numeric constant or fixed address, or a reference to a <em>block</em>. A block may be one of:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Block Kind   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>code block</em>   </td><td class="markdownTableBodyNone">a series of executable instructions    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><em>data block</em>   </td><td class="markdownTableBodyNone">a series of data bytes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>proxy block</em>   </td><td class="markdownTableBodyNone">indicating that the symbol is defined in another module   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md229"></a>
Byte Intervals</h3>
<p><a class="anchor" id="byte-intervals"></a></p>
<p>The bytes of a section are subdivided into chunks of bytes called <em>byte intervals</em>. This indirection layer serves two purposes:</p>
<ul>
<li>Indicate what blocks can be moved independently of each other. It is guaranteed that you can shuffle around two byte intervals in a section, and doing so will preserve the program's semantics.</li>
<li>Support the generation of blocks with no original address. Byte intervals may have a fixed address, but they may also be unfixed, likely indicating that the byte interval was generated by a binary rewriting tool or is freely movable to any address.</li>
</ul>
<p>Two byte intervals in the same section may not overlap in addresses (although sections can overlap with each other in some cases, such as in object code). Byte intervals contain code blocks or data blocks. The blocks within a byte interval <em>can</em> overlap. Examples of overlapping blocks include:</p>
<ul>
<li>Overlapping data blocks are common.<ul>
<li>One data block may representing an array may overlap many data blocks representing elements of the array.</li>
<li>Compilers often overlap strings with shared suffixes. The data blocks representing these strings will similarly overlap.</li>
</ul>
</li>
<li>Overlapping code blocks are rare, however particularly clever or malicious code blocks in variable-width ISAs may overlap when two different sequences of instructions serialize to machine-code bytes which share common subsequences.</li>
</ul>
<p>Byte intervals also hold <a href="#symbolic-expressions">symbolic expressions</a> which indicate symbolic contents of code or data blocks.</p>
<h3><a class="anchor" id="autotoc_md230"></a>
Symbolic Expressions</h3>
<p><a class="anchor" id="symbolic-expressions"></a></p>
<p>To encode relocations, GTIRB associates <em>symbolic expressions</em> with byte-intervals. These specify that certain bytes in the binary refer to the address. This allows these bytes to be recalculated when the referent is moved in the binary image.</p>
<p>GTIRB does not specify exactly how symbolic expressions are transformed into bytes. This depends on where the symbolic expression is located; inside a code block, it depends on what part of an instruction it is of, while inside a data block, it depends on the size of the data block.</p>
<p>There are currently three kinds of symbolic expressions:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Kind   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>SymStackConst</em>   </td><td class="markdownTableBodyNone">the address of a stack variable, plus or minus a fixed offset    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><em>SymAddrConst</em>   </td><td class="markdownTableBodyNone">the address of the referent of a symbol, plus or minus a fixed offset    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>SymAddrAddr</em>   </td><td class="markdownTableBodyNone">the difference between two symbols, divided by a scale and plus an offset   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
